<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:redisson="http://redisson.org/schema/redisson"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://redisson.org/schema/redisson http://redisson.org/schema/redisson/redisson.xsd
      ">


    <!-- Redisson Config    -->
    <redisson:client id="redissonClient" threads="${redisson.use.threads:800}" netty-threads="0"
                     use-linux-native-epoll="${redisson.use.linux.epoll:true}">
        <redisson:single-server client-name="hdpServer" address="${redisson.server.host}"
                                password="${redisson.server.password}"
                                database="${redisson.server.database:0}"
                                connect-timeout="10000" timeout="3000"
                                reconnection-timeout="3000" retry-attempts="3" retry-interval="1500"
                                idle-connection-timeout="10000"
                                connection-minimum-idle-size="${redisson.connection.minimum.idle.size:32}"
                                connection-pool-size="${redisson.connection.pool.size:1000}"
                                subscription-connection-minimum-idle-size="5"
                                subscription-connection-pool-size="100"/>

        <redisson:remote-service id="hdpServerForGateway" service="HdpServerForGateway"/>

    </redisson:client>

    <redisson:rpc-server api-class="com.yuntai.hdp.access.service.AccessHospitalHandler"
                         remote-service-ref="hdpServerForGateway"
                         bean="accessHospitalHandler"
                         concurrent-workers="10"/> <!-- HdpGateway 访问 HdpServer 使用 redis 方式时，concurrent 需要增大 -->

    <redisson:rpc-server api-class="com.yuntai.hdp.access.service.DowndataHandler"
                         remote-service-ref="hdpServerForGateway"
                         bean="downdataHandler"
                         concurrent-workers="2"/>

</beans>